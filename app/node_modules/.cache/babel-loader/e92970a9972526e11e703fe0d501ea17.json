{"ast":null,"code":"import { createNamespace, isDef } from '../utils';\nimport { doubleRaf, raf } from '../utils/dom/raf';\nimport { BindEventMixin } from '../mixins/bind-event';\nimport Icon from '../icon';\n\nvar _createNamespace = createNamespace('notice-bar'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind) {\n    // fix cache issues with forwards and back history in safari\n    // see: https://guwii.com/cache-issues-with-forwards-and-back-history-in-safari/\n    bind(window, 'pageshow', this.reset);\n  })],\n  inject: {\n    vanPopup: {\n      default: null\n    }\n  },\n  props: {\n    text: String,\n    mode: String,\n    color: String,\n    leftIcon: String,\n    wrapable: Boolean,\n    background: String,\n    scrollable: {\n      type: Boolean,\n      default: null\n    },\n    delay: {\n      type: [Number, String],\n      default: 1\n    },\n    speed: {\n      type: [Number, String],\n      default: 60\n    }\n  },\n  data: function data() {\n    return {\n      show: true,\n      offset: 0,\n      duration: 0,\n      wrapWidth: 0,\n      contentWidth: 0\n    };\n  },\n  watch: {\n    scrollable: 'reset',\n    text: {\n      handler: 'reset',\n      immediate: true\n    }\n  },\n  created: function created() {\n    // https://github.com/youzan/vant/issues/8634\n    if (this.vanPopup) {\n      this.vanPopup.onReopen(this.reset);\n    }\n  },\n  activated: function activated() {\n    this.reset();\n  },\n  methods: {\n    onClickIcon: function onClickIcon(event) {\n      if (this.mode === 'closeable') {\n        this.show = false;\n        this.$emit('close', event);\n      }\n    },\n    onTransitionEnd: function onTransitionEnd() {\n      var _this = this;\n\n      this.offset = this.wrapWidth;\n      this.duration = 0; // wait for Vue to render offset\n      // using nextTick won't work in iOS14\n\n      raf(function () {\n        // use double raf to ensure animation can start\n        doubleRaf(function () {\n          _this.offset = -_this.contentWidth;\n          _this.duration = (_this.contentWidth + _this.wrapWidth) / _this.speed;\n\n          _this.$emit('replay');\n        });\n      });\n    },\n    // not an exposed-api, but may used by some users\n    start: function start() {\n      this.reset();\n    },\n    // @exposed-api\n    reset: function reset() {\n      var _this2 = this;\n\n      var delay = isDef(this.delay) ? this.delay * 1000 : 0;\n      this.offset = 0;\n      this.duration = 0;\n      this.wrapWidth = 0;\n      this.contentWidth = 0;\n      clearTimeout(this.startTimer);\n      this.startTimer = setTimeout(function () {\n        var _this2$$refs = _this2.$refs,\n            wrap = _this2$$refs.wrap,\n            content = _this2$$refs.content;\n\n        if (!wrap || !content || _this2.scrollable === false) {\n          return;\n        }\n\n        var wrapWidth = wrap.getBoundingClientRect().width;\n        var contentWidth = content.getBoundingClientRect().width;\n\n        if (_this2.scrollable || contentWidth > wrapWidth) {\n          doubleRaf(function () {\n            _this2.offset = -contentWidth;\n            _this2.duration = contentWidth / _this2.speed;\n            _this2.wrapWidth = wrapWidth;\n            _this2.contentWidth = contentWidth;\n          });\n        }\n      }, delay);\n    }\n  },\n  render: function render() {\n    var _this3 = this;\n\n    var h = arguments[0];\n    var slots = this.slots,\n        mode = this.mode,\n        leftIcon = this.leftIcon,\n        onClickIcon = this.onClickIcon;\n    var barStyle = {\n      color: this.color,\n      background: this.background\n    };\n    var contentStyle = {\n      transform: this.offset ? \"translateX(\" + this.offset + \"px)\" : '',\n      transitionDuration: this.duration + 's'\n    };\n\n    function LeftIcon() {\n      var slot = slots('left-icon');\n\n      if (slot) {\n        return slot;\n      }\n\n      if (leftIcon) {\n        return h(Icon, {\n          \"class\": bem('left-icon'),\n          \"attrs\": {\n            \"name\": leftIcon\n          }\n        });\n      }\n    }\n\n    function RightIcon() {\n      var slot = slots('right-icon');\n\n      if (slot) {\n        return slot;\n      }\n\n      var iconName;\n\n      if (mode === 'closeable') {\n        iconName = 'cross';\n      } else if (mode === 'link') {\n        iconName = 'arrow';\n      }\n\n      if (iconName) {\n        return h(Icon, {\n          \"class\": bem('right-icon'),\n          \"attrs\": {\n            \"name\": iconName\n          },\n          \"on\": {\n            \"click\": onClickIcon\n          }\n        });\n      }\n    }\n\n    return h(\"div\", {\n      \"attrs\": {\n        \"role\": \"alert\"\n      },\n      \"directives\": [{\n        name: \"show\",\n        value: this.show\n      }],\n      \"class\": bem({\n        wrapable: this.wrapable\n      }),\n      \"style\": barStyle,\n      \"on\": {\n        \"click\": function click(event) {\n          _this3.$emit('click', event);\n        }\n      }\n    }, [LeftIcon(), h(\"div\", {\n      \"ref\": \"wrap\",\n      \"class\": bem('wrap'),\n      \"attrs\": {\n        \"role\": \"marquee\"\n      }\n    }, [h(\"div\", {\n      \"ref\": \"content\",\n      \"class\": [bem('content'), {\n        'van-ellipsis': this.scrollable === false && !this.wrapable\n      }],\n      \"style\": contentStyle,\n      \"on\": {\n        \"transitionend\": this.onTransitionEnd\n      }\n    }, [this.slots() || this.text])]), RightIcon()]);\n  }\n});","map":{"version":3,"names":["createNamespace","isDef","doubleRaf","raf","BindEventMixin","Icon","_createNamespace","createComponent","bem","mixins","bind","window","reset","inject","vanPopup","default","props","text","String","mode","color","leftIcon","wrapable","Boolean","background","scrollable","type","delay","Number","speed","data","show","offset","duration","wrapWidth","contentWidth","watch","handler","immediate","created","onReopen","activated","methods","onClickIcon","event","$emit","onTransitionEnd","_this","start","_this2","clearTimeout","startTimer","setTimeout","_this2$$refs","$refs","wrap","content","getBoundingClientRect","width","render","_this3","h","arguments","slots","barStyle","contentStyle","transform","transitionDuration","LeftIcon","slot","RightIcon","iconName","name","value","click"],"sources":["/Volumes/T7-haodong/HTML_studying/项目/vue-vant项目-谁是卧底/app/node_modules/vant/es/notice-bar/index.js"],"sourcesContent":["import { createNamespace, isDef } from '../utils';\nimport { doubleRaf, raf } from '../utils/dom/raf';\nimport { BindEventMixin } from '../mixins/bind-event';\nimport Icon from '../icon';\n\nvar _createNamespace = createNamespace('notice-bar'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind) {\n    // fix cache issues with forwards and back history in safari\n    // see: https://guwii.com/cache-issues-with-forwards-and-back-history-in-safari/\n    bind(window, 'pageshow', this.reset);\n  })],\n  inject: {\n    vanPopup: {\n      default: null\n    }\n  },\n  props: {\n    text: String,\n    mode: String,\n    color: String,\n    leftIcon: String,\n    wrapable: Boolean,\n    background: String,\n    scrollable: {\n      type: Boolean,\n      default: null\n    },\n    delay: {\n      type: [Number, String],\n      default: 1\n    },\n    speed: {\n      type: [Number, String],\n      default: 60\n    }\n  },\n  data: function data() {\n    return {\n      show: true,\n      offset: 0,\n      duration: 0,\n      wrapWidth: 0,\n      contentWidth: 0\n    };\n  },\n  watch: {\n    scrollable: 'reset',\n    text: {\n      handler: 'reset',\n      immediate: true\n    }\n  },\n  created: function created() {\n    // https://github.com/youzan/vant/issues/8634\n    if (this.vanPopup) {\n      this.vanPopup.onReopen(this.reset);\n    }\n  },\n  activated: function activated() {\n    this.reset();\n  },\n  methods: {\n    onClickIcon: function onClickIcon(event) {\n      if (this.mode === 'closeable') {\n        this.show = false;\n        this.$emit('close', event);\n      }\n    },\n    onTransitionEnd: function onTransitionEnd() {\n      var _this = this;\n\n      this.offset = this.wrapWidth;\n      this.duration = 0; // wait for Vue to render offset\n      // using nextTick won't work in iOS14\n\n      raf(function () {\n        // use double raf to ensure animation can start\n        doubleRaf(function () {\n          _this.offset = -_this.contentWidth;\n          _this.duration = (_this.contentWidth + _this.wrapWidth) / _this.speed;\n\n          _this.$emit('replay');\n        });\n      });\n    },\n    // not an exposed-api, but may used by some users\n    start: function start() {\n      this.reset();\n    },\n    // @exposed-api\n    reset: function reset() {\n      var _this2 = this;\n\n      var delay = isDef(this.delay) ? this.delay * 1000 : 0;\n      this.offset = 0;\n      this.duration = 0;\n      this.wrapWidth = 0;\n      this.contentWidth = 0;\n      clearTimeout(this.startTimer);\n      this.startTimer = setTimeout(function () {\n        var _this2$$refs = _this2.$refs,\n            wrap = _this2$$refs.wrap,\n            content = _this2$$refs.content;\n\n        if (!wrap || !content || _this2.scrollable === false) {\n          return;\n        }\n\n        var wrapWidth = wrap.getBoundingClientRect().width;\n        var contentWidth = content.getBoundingClientRect().width;\n\n        if (_this2.scrollable || contentWidth > wrapWidth) {\n          doubleRaf(function () {\n            _this2.offset = -contentWidth;\n            _this2.duration = contentWidth / _this2.speed;\n            _this2.wrapWidth = wrapWidth;\n            _this2.contentWidth = contentWidth;\n          });\n        }\n      }, delay);\n    }\n  },\n  render: function render() {\n    var _this3 = this;\n\n    var h = arguments[0];\n    var slots = this.slots,\n        mode = this.mode,\n        leftIcon = this.leftIcon,\n        onClickIcon = this.onClickIcon;\n    var barStyle = {\n      color: this.color,\n      background: this.background\n    };\n    var contentStyle = {\n      transform: this.offset ? \"translateX(\" + this.offset + \"px)\" : '',\n      transitionDuration: this.duration + 's'\n    };\n\n    function LeftIcon() {\n      var slot = slots('left-icon');\n\n      if (slot) {\n        return slot;\n      }\n\n      if (leftIcon) {\n        return h(Icon, {\n          \"class\": bem('left-icon'),\n          \"attrs\": {\n            \"name\": leftIcon\n          }\n        });\n      }\n    }\n\n    function RightIcon() {\n      var slot = slots('right-icon');\n\n      if (slot) {\n        return slot;\n      }\n\n      var iconName;\n\n      if (mode === 'closeable') {\n        iconName = 'cross';\n      } else if (mode === 'link') {\n        iconName = 'arrow';\n      }\n\n      if (iconName) {\n        return h(Icon, {\n          \"class\": bem('right-icon'),\n          \"attrs\": {\n            \"name\": iconName\n          },\n          \"on\": {\n            \"click\": onClickIcon\n          }\n        });\n      }\n    }\n\n    return h(\"div\", {\n      \"attrs\": {\n        \"role\": \"alert\"\n      },\n      \"directives\": [{\n        name: \"show\",\n        value: this.show\n      }],\n      \"class\": bem({\n        wrapable: this.wrapable\n      }),\n      \"style\": barStyle,\n      \"on\": {\n        \"click\": function click(event) {\n          _this3.$emit('click', event);\n        }\n      }\n    }, [LeftIcon(), h(\"div\", {\n      \"ref\": \"wrap\",\n      \"class\": bem('wrap'),\n      \"attrs\": {\n        \"role\": \"marquee\"\n      }\n    }, [h(\"div\", {\n      \"ref\": \"content\",\n      \"class\": [bem('content'), {\n        'van-ellipsis': this.scrollable === false && !this.wrapable\n      }],\n      \"style\": contentStyle,\n      \"on\": {\n        \"transitionend\": this.onTransitionEnd\n      }\n    }, [this.slots() || this.text])]), RightIcon()]);\n  }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}